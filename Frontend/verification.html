<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChopSmo - Verification System</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="index.css">
    <link rel="stylesheet" href="verification.css">
</head>
<body class="verification-page">
    <header>
        <div class="container">
            <nav>
                <div class="logo">
                    <a href="index.html">
                        <i class="fas fa-utensils"></i>
                        <span>ChopSmo</span>
                    </a>
                </div>
                <ul class="nav-links">
                    <li><a href="DashBoard.html">Dashboard</a></li>
                    <li><a href="MealPlans.html">Meal Plans</a></li>
                    <li><a href="MealSuggestion.html">Suggestions</a></li>
                    <li><a href="Recipes.html">Recipes</a></li>
                </ul>
                <div class="auth-buttons">
                    <button id="logoutBtn" class="btn btn-outline">Logout</button>
                </div>
                <div class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <main style="padding: 140px 0 var(--space-16); min-height: calc(100vh - 140px); overflow-y: auto;">
        <div class="container verification-page-container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
            <!-- Verification Status Panel -->
            <div id="verificationPanel" class="verification-status-panel">
                <!-- Content will be dynamically loaded here -->
            </div>

            <!-- Application Form Modal -->
            <div id="applicationModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 600px;">
                    <button id="closeApplicationModal" class="modal-close-btn">&times;</button>
                    <div class="verification-form">
                        <div class="verification-form-header">
                            <h2 class="verification-form-title">
                                <i class="fas fa-certificate"></i>
                                Become a Verified Contributor
                            </h2>
                            <p class="verification-form-description">
                                Join our community of verified chefs and cooking enthusiasts. Share your recipes with confidence and get recognized for your culinary expertise.
                            </p>
                        </div>

                        <form id="verificationApplicationForm">
                            <div class="verification-form-group">
                                <label for="fullName" class="verification-form-label">
                                    Full Name *
                                </label>
                                <input 
                                    type="text" 
                                    id="fullName" 
                                    name="full_name" 
                                    class="verification-form-input" 
                                    placeholder="Enter your full name"
                                    required
                                >
                            </div>

                            <div class="verification-form-group">
                                <label for="cookingExperience" class="verification-form-label">
                                    Cooking Experience *
                                </label>
                                <textarea 
                                    id="cookingExperience" 
                                    name="cooking_experience" 
                                    class="verification-form-textarea" 
                                    placeholder="Describe your cooking experience, qualifications, and background (minimum 50 characters)..."
                                    required
                                    minlength="50"
                                ></textarea>
                            </div>

                            <div class="verification-form-group">
                                <label for="specialties" class="verification-form-label">
                                    Specialties *
                                </label>
                                <input 
                                    type="text" 
                                    id="specialties" 
                                    name="specialties" 
                                    class="verification-form-input" 
                                    placeholder="e.g. Nigerian cuisine, vegan meals"
                                    required
                                >
                            </div>

                            <div class="verification-form-group">
                                <label for="socialMediaLinks" class="verification-form-label">
                                    Social Media Links *
                                </label>
                                <input 
                                    type="text" 
                                    id="socialMediaLinks" 
                                    name="social_media_links" 
                                    class="verification-form-input" 
                                    placeholder="e.g. https://instagram.com/yourprofile, https://twitter.com/yourprofile"
                                    required
                                >
                            </div>

                            <div class="verification-form-group">
                                <label for="sampleRecipes" class="verification-form-label">
                                    Sample Recipes *
                                </label>
                                <input 
                                    type="text" 
                                    id="sampleRecipes" 
                                    name="sample_recipes" 
                                    class="verification-form-input" 
                                    placeholder="List a few of your signature recipes (comma separated)"
                                    required
                                >
                            </div>

                            <div class="verification-form-group">
                                <label for="motivation" class="verification-form-label">
                                    Motivation *
                                </label>
                                <textarea 
                                    id="motivation" 
                                    name="motivation" 
                                    class="verification-form-textarea" 
                                    placeholder="Why do you want to become a verified contributor? (minimum 30 characters)"
                                    required
                                    minlength="30"
                                ></textarea>
                            </div>

                            <button type="submit" class="verification-form-submit" id="submitApplication">
                                <i class="fas fa-paper-plane"></i>
                                Submit Application
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Admin Panel (only visible to admins) -->
            <div id="adminPanel" class="admin-applications-container" style="display: none;">
                <div class="admin-applications-header">
                    <h2 class="admin-applications-title">
                        <i class="fas fa-user-check"></i>
                        Verification Applications
                    </h2>
                    <span class="admin-applications-count" id="applicationsCount">0 Pending</span>
                </div>
                
                <div class="admin-filters" style="margin-bottom: 24px;">
                    <select id="statusFilter" style="padding: 8px 12px; border-radius: 6px; border: 1px solid #ddd;">
                        <option value="">All Applications</option>
                        <option value="pending">Pending</option>
                        <option value="approved">Approved</option>
                        <option value="rejected">Rejected</option>
                    </select>
                </div>

                <div id="applicationsList">
                    <!-- Applications will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <footer>
        <!-- Same footer as other pages -->
    </footer>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" style="display: none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; background: rgba(255, 255, 255, 0.9); z-index: 9999; align-items: center; justify-content: center;">
        <div style="width: 50px; height: 50px; border: 4px solid #f3f3f3; border-top: 4px solid #228B22; border-radius: 50%; animation: spin 1s linear infinite;"></div>
    </div>

    <!-- Add CSS for spinner animation -->
    <style>
    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
    
    #loadingSpinner.show {
        display: flex !important;
    }
    
    .toast-success {
        background: #4caf50 !important;
    }
    
    .toast-warning {
        background: #ff9800 !important;
    }
    
    .toast-error {
        background: #f44336 !important;
    }
    
    .toast-info {
        background: #2196f3 !important;
    }
    </style>

    <!-- Toast Notification -->
    <div id="toastMessage" style="display: none; position: fixed; bottom: 30px; right: 30px; background: #228B22; color: white; padding: 16px 24px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 10000;"></div>

    <script src="mobile-nav.js?v=6"></script>
    <script src="universal-verification.js"></script>
    <script src="verification.js"></script>
    
    <!-- Simplified Enhanced Verification Status Checking -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        console.log('🔧 Verification page enhancement loaded');
        
        // Simple manual test functions for console
        window.testCurrentVerificationStatus = async function() {
            console.log('🧪 Testing current verification status...');
            
            try {
                if (window.universalVerification) {
                    const status = await window.universalVerification.forceRefreshVerificationStatus();
                    console.log('🔍 Current status:', status);
                    return status;
                } else {
                    console.log('❌ Universal verification system not available');
                    return null;
                }
            } catch (error) {
                console.error('❌ Test failed:', error);
                return null;
            }
        };
        
        window.simulateVerificationChange = function(isVerified = true) {
            console.log('🎭 Simulating verification change to:', isVerified);
            
            if (window.verificationSystem) {
                const mockStatus = {
                    status: isVerified ? 'approved' : 'not_applied',
                    is_verified: isVerified,
                    application: isVerified ? {
                        business_name: 'Test User',
                        created_at: new Date().toISOString()
                    } : null,
                    verification_source: 'test_simulation'
                };
                
                window.verificationSystem.updateVerificationPanel(mockStatus);
                console.log('✅ UI updated with simulated status');
            } else {
                console.log('❌ Verification system not available');
            }
        };
        
        // Add some helpful UI feedback
        setTimeout(() => {
            console.log('�️ Verification page test functions available:');
            console.log('  - testCurrentVerificationStatus() - Test verification status');
            console.log('  - simulateVerificationChange(true/false) - Simulate status change');
            console.log('  - forceRefreshVerificationSystem() - Force refresh');
        }, 2000);
    });
    </script>
</body>
</html>
